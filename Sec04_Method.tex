\section{Method}

A simple interpolation from the Atlantic tidal solutions to the model grid might not be sufficient close to the coast because fjords and the coastline itself are not properly resolved. In order to omit this problem, other fjord models apply tidal amplitude and phase from observed water level close to the boundary \cite[i.e.]{foreman90,svendsen96,lynge13}. In the ROMS model it is preferable to also include the tidal current major amplitude, minor amplitude, phase, and inclination angle. Here we propose a method on how to adjust the global tidal forcing in terms of both elevation and depth integrated currents, to local ocean models. 

The criterion for this method to work properly is that the open boundary should be as parallel as possible to the face of the tidal wave, or that the width of the open boundary is small enough for the phase shift along the boundary to be negligible. There must also be water level observations available at, or close to, the open boundary.

The method is straight forward. First the tidal forcing, the Atlantic TPXO with a resolution of 1/30 degree, was imposed at the open boundaries of the fjord models. The simulated time period was 150 days starting 1 April 2014. 

Time series of observed and modelled water level from locations near the tidal gauge stations close to the open boundaries, were extracted and analysed using the T\_Tide package described by \cite{pawlowicz02}. For the Oslofjord model, observed and modelled water level are extracted from a location near Viker which lies inside the model domain. For the Saltfjord model, observed and modelled water level are extracted from a location near Bod{\o} which lies slightly outside the model domain. The standard set of 69 components are applied in the analyses using T\_Tide. In the evaluation, only the components included in or derived from the tidal forcing are considered.

To better match the observations, the tidal amplitudes and corresponding phases were modified by computing an amplitude factor, $c^{(n)}$, and a phase shift, $\triangle \phi^{(n)}$, for each tidal component $n$ for the water level according to:
\begin{eqnarray}
c^{(n)} &=& \frac{a^{(n)}_{obs}}{a^{(n)}_{sim}} \\
\triangle \phi^{(n)} &=& \phi^{(n)}_{obs} - \phi^{(n)}_{sim}
\end{eqnarray}
$a^{(n)}_{obs}$ and $a^{(n)}_{sim}$ are the observed and modelled amplitudes respectively. $\phi^{(n)}_{obs}$ and $\phi^{(n)}_{sim}$ are the observed and modelled phases respectively. 

New amplitudes and phases at the boundary were then calculated using the computed factors and phase shifts on both water level and velocity. A linear relationship between change in sea level and velocity is assumed. The new amplitudes and phases imposed at the open boundaries of new simulations where taken as:
\begin{eqnarray}
a^{(n)}_{i2} &=& a^{(n)}_{i1} c^{(n)} \\
\phi^{(n)}_{i2} &=& \phi^{(n)}_{i1} + \triangle \phi^{(n)}
\end{eqnarray}
$a^{(n)}_{i1}$ and $\phi^{(n)}_{i1}$ are the amplitude and phase originally imposed on grid cell $i$ along the boundary. Modified major and minor amplitude and phase for the tidal current are adjusted in the same way using the amplitude factor and phase shift calculated from the water level. The inclination angles are not adjusted.

After the adjusted tidal forcing is generated, both models are rerun using the new tidal forcing. The results are then analysed the same way as for the first run, and compared with observed tidal water level and currents. 

The root mean square errors are calculated for both model runs according to:
\begin{eqnarray}
RMSE = \sqrt{\frac{1}{N} \sum_{n=1}^N (\eta^{mod}_n - \eta^{obs}_n)^2}
\end{eqnarray}
where $N$ is the number of time steps in the observed and modelled water level series at selected positions, $\eta_n$. A similar equation is applied on the depth averaged tidal currents.
