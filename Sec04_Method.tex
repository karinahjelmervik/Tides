\section{Method}

Commonly open ocean tidal information from a coarser model is simply interpolated onto the finer model grid of the regional model. This approach might not be sufficient in our case because the many small and large islands inside the fjord and the fjord's irregular coastline are not properly resolved in the Atlantic TPXO tidal solutions. In order to avoid this problem it has previousy been common to apply tidal amplitude and phase from observed water levels close to the boundary \cite[i.e.]{foreman90,svendsen96,lynge13}. 

We take a somewhat different approach in that we propose a method on how to correct the global tidal forcing in terms of both elevation and depth integrated currents. The method is straightforward. In summary we first run the model using raw tidal forcing on the open boundary of the fjord or regional model. Comparing modelled and observed time series of water level at a tidal gauge station close to the open boundary of the Oslofjord model, a factor for the amplitude and a shift in phase is computed. The amplitude factor and the phase shift are then applied to produce adjusted tidal forcing at the open boundary. Next we rerun the fjord model using the adjusted tidal forcing. The results from the two runs are then compared to independent observations inside the fjord in terms of amplitude and phases of the various tidal components, the total tidal water level, and the tidal currents. To evaluate the method, we present results for the Oslofjord, Norway using the Oslofjord model as described in Section \ref{sec:model_setup}. 

One of the requirements for our method to work properly is that the phase shift along the boundary is negligible. This is achieved if the open boundary is as parallel as possible to the face of the tidal wave, or if the width of the open boundary is small enough. Another requirement is that there must be at least one water level observations available at, or close to, the open boundary.

The application to the Oslofjord consists of two steps. In the first step we first extract the relevant tidal forcing from the Atlantic TPXO global model which has a resolution of 1/30 degree. It is then imposed at the open boundaries of the Oslofjord model, and a 150 day simulation starting 1 April 2014 is performed (henceforth Run 1). Next time series of observed and modelled water level from the Viker tidal gauge station, which is close to the open boundary of the Oslofjord model (Fig. \ref{fig:area1}), are extracted and analysed using the T\_Tide package described by \cite{pawlowicz02}. The standard set of 69 components are applied in the analyses, but only the components included in or derived from the global tidal forcing are considered.
%For the Saltfjord model, observed and modelled water level are extracted from a location near Bod{\o} which lies slightly outside the model domain. 
 
The open boundary for the Oslofjord is less than 50 km wide, which is relatively narrow. There is also a second tidal gauge station at Helgeroa (Fig. \ref{fig:area1}) to our disposal. Hower, a tidal analysis reveals that the harmonic components from the Helgeroa stations differ with less than 0.5 cm for the amplitudes and 1 degree for the phases \cite[]{tide16} from the Viker station. We therefore deemed it sufficient in this study to include the Viker station only. We emphasize though that for fjords exhibiting wider openings it might be necessary to apply more than one station. 

As part of step 1 we then compare the observations and the results from Run 1 at the Viker station in terms of their tidal amplitudes and corresponding phases. An amplitude factor, $c^{(n)}$, and a phase shift, $\triangle \phi^{(n)}$, for each tidal component $n$ is then computed according to
\begin{eqnarray}
c^{(n)} &=& \frac{a^{(n)}_{obs}}{a^{(n)}_{sim}}, \\
\triangle \phi^{(n)} &=& \phi^{(n)}_{obs} - \phi^{(n)}_{sim},
\end{eqnarray}
where $a^{(n)}_{obs}$ and $a^{(n)}_{sim}$ are the observed and modelled amplitudes and $\phi^{(n)}_{obs}$ and $\phi^{(n)}_{sim}$ are the observed and modelled phases, respectively. 

In the second step we correct the amplitudes and phases at the boundary using the above computed factors and phase shifts. The corrected amplitudes and phases are simply
\begin{eqnarray}
a^{(n)}_{i2} &=& a^{(n)}_{i1} c^{(n)}, \\
\phi^{(n)}_{i2} &=& \phi^{(n)}_{i1} + \triangle \phi^{(n)},
\end{eqnarray}
where $a^{(n)}_{i1}$ and $\phi^{(n)}_{i1}$ are the amplitude and phase originally imposed on grid cell $i$ along the boundary in Run 1. Modified major and minor amplitude and phase for the tidal current are adjusted in the same way using the amplitude factor and phase shift calculated from the water level. In this we assume a linear relation between water level and currents. The inclination angles are not adjusted.

Next we rerun the Oslofjordmodel using the corrected tidal forcing (henceforth Run 2) for the same period as Run 1. The results are then analysed the same way as for Run 1. Finally we compare the results from Run 2 with the observed tidal water level and currents (Section \ref{sec:discuss}. 

%The root mean square errors are calculated for both model runs according to:
%\begin{eqnarray}
%RMSE = \sqrt{\frac{1}{N} \sum_{n=1}^N (\eta^{mod}_n - \eta^{obs}_n)^2}
%\end{eqnarray}
%where $N$ is the number of time steps in the observed and modelled water level series at selected positions, $\eta_n$. A similar equation is applied on the depth averaged tidal currents.
